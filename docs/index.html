<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>easy-git-annex</title><meta name="description" content="Documentation for easy-git-annex"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">easy-git-annex</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>easy-git-annex</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography"><p><a href="https://renovatebot.com/"><img src="https://img.shields.io/badge/renovate-enabled-brightgreen.svg" alt="Renovate Status"></a>
<a href="https://github.com/jstritch/easy-git-annex/actions"><img src="https://github.com/jstritch/easy-git-annex/workflows/CI/badge.svg" alt="CI Status"></a>
<img src="https://github.com/jstritch/easy-git-annex/blob/master/coverage/badge.svg?raw=true" alt="Test Coverage"></p>

<a href="#easy-git-annex" id="easy-git-annex" style="color: inherit; text-decoration: none;">
  <h1>easy-git-annex</h1>
</a>
<p>The easy-git-annex package is a JavaScript/TypeScript API for git-annex and Git commands.
<a href="https://git-annex.branchable.com/">git-annex</a> is an integrated alternative
to storing large files in <a href="https://git-scm.com/">Git</a>.</p>
<p>The easy-git-annex API is a wrapper over git-annex and Git commands.
Applications pass JavaScript objects with command options and parameters
to easy-git-annex which generates the appropriate syntax and runs the command.</p>
<p>Each command is run asynchronously without blocking the Node.js event loop.
The Promise returned from every command has the same structure and
includes the command and its arguments, repository path, exit code, stdout, and stderr.</p>
<p>Helper functions assist the application with parsing command responses.</p>
<p>Callbacks for stdout and stderr are available to show progress of time-consuming commands.
Environment variables may also be specified.</p>

<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
  <h2>Installation</h2>
</a>
<p>Both Git and git-annex must be installed and verified to run from the command line.
Current versions of git-annex are available from the <a href="https://downloads.kitenet.net/">developer</a>.</p>
<p>Installation of easy-git-annex may be performed with the command</p>
<p><code>npm install easy-git-annex</code></p>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2>Usage</h2>
</a>
<p>Reference the library from your code.</p>
<pre><code class="language-javascript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">anx</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;easy-git-annex&#39;</span><span class="hl-1">;</span>
</code></pre>
<p>Obtain an accessor to use the GitAnnexAPI interface with the desired repository.
The directory passed to createAccessor must exist.
The GitAnnexAPI interface is described in the documentation.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">myAnx</span><span class="hl-1"> = </span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-6">createAccessor</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">);</span>
</code></pre>
<p>An application may hold multiple accessors simultaneously.</p>

<a href="#commands" id="commands" style="color: inherit; text-decoration: none;">
  <h3>Commands</h3>
</a>
<p>Git and git-annex commands are exposed by methods on the GitAnnexAPI interface.
Frequently used commands, such as commit, have a specific method to invoke the command.
Low-level methods runGit and runAnx are capable of invoking any Git or git-annex command.</p>
<p>A process is spawned to run each command asynchronously.
The ApiOptions, described below, may be used to influence process creation.</p>
<p>Additional methods return JavaScript objects for tasks common to many applications,
for example getStatusAnx and getStatusGit.</p>

<a href="#command-options" id="command-options" style="color: inherit; text-decoration: none;">
  <h3>Command options</h3>
</a>
<p>Most git-annex and Git commands accept one or more options.
Options may be passed in an object or a string array.
When an object is passed, easy-git-annex handles the mechanics of generating the correct command syntax.
The string array approach is intended for command options not yet implemented by easy-git-annex.</p>
<p>To pass options, construct an object with the desired keys and values.
Any keys in the object not for the command are ignored.
Command option names containing hyphens must be enclosed
in single or double quotation marks to be valid JavaScript identifiers.</p>
<p>Several types of option values are used.
Arrays of the appropriate type are used for options accepting more than one value and options which may be repeated.</p>

<a href="#scalar" id="scalar" style="color: inherit; text-decoration: none;">
  <h4>Scalar</h4>
</a>
<p>Some options accept a single value.
The following JavaScript adds files using at most two CPU cores.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">addResult</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">addAnx</span><span class="hl-1">(</span><span class="hl-3">relativePaths</span><span class="hl-1">, { </span><span class="hl-4">&#39;--jobs&#39;</span><span class="hl-3">:</span><span class="hl-1"> </span><span class="hl-7">2</span><span class="hl-1"> });</span>
</code></pre>

<a href="#flag" id="flag" style="color: inherit; text-decoration: none;">
  <h4>Flag</h4>
</a>
<p>Some options do not accept a value. Supply a <code>null</code> value for these options.
The JavaScript below obtains a list of Git remotes and the associated URLs.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">remoteResult</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">remote</span><span class="hl-1">(</span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-3">RemoteCommand</span><span class="hl-1">.</span><span class="hl-3">Show</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">, { </span><span class="hl-4">&#39;--verbose&#39;</span><span class="hl-3">:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1"> });</span>
</code></pre>

<a href="#key-value-pair" id="key-value-pair" style="color: inherit; text-decoration: none;">
  <h4>Key-value pair</h4>
</a>
<p>Options that require a key-value pair accept a tuple of [string, string]
containing the key name and value.
An example git-annex configuration setting appears below.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">configResult</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">configAnx</span><span class="hl-1">({ </span><span class="hl-4">&#39;--set&#39;</span><span class="hl-3">:</span><span class="hl-1"> [</span><span class="hl-4">&#39;annex.largefiles&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;include=*.mp3 or include=*.jpg&#39;</span><span class="hl-1">] });</span>
</code></pre>

<a href="#string-array" id="string-array" style="color: inherit; text-decoration: none;">
  <h4>String array</h4>
</a>
<p>An application may choose to construct the options as a string array.
The following line is functionally equivalent to the scalar example above.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">addResult</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">addAnx</span><span class="hl-1">(</span><span class="hl-3">relativePaths</span><span class="hl-1">, [</span><span class="hl-4">&#39;--jobs=2&#39;</span><span class="hl-1">]);</span>
</code></pre>

<a href="#command-parameters" id="command-parameters" style="color: inherit; text-decoration: none;">
  <h3>Command parameters</h3>
</a>
<p>Some command accept parameters such as relative paths of file names.
Git and git-annex commands use forward slash path separators regardless of platform.
The gitPath and gitPaths functions perform the conversions when necessary.</p>
<p>The gitPath and gitPaths functions are called internally by easy-git-annex for implemented relative path parameters.
When building a low-level command, calling gitPath and gitPaths is the application&#39;s responsibility.
The following JavaScript illustrates a low-level call of the Git add command.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">addResult</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">runGit</span><span class="hl-1">([</span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">, </span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-6">gitPath</span><span class="hl-1">(</span><span class="hl-3">relativePath</span><span class="hl-1">)]);</span>
</code></pre>

<a href="#api-options" id="api-options" style="color: inherit; text-decoration: none;">
  <h3>API options</h3>
</a>
<p>An application may control the environment variables passed to the command and
register callbacks for stdout and stderr using ApiOptions.</p>
<p>The fragment below clones the current environment,
adds variable GIT_TRACE to the copy, and establishes callback handlers for the output.
The apiOptions parameter is accepted by easy-git-annex command methods.</p>
<pre><code class="language-javascript"><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">onConsoleOut</span><span class="hl-1">(</span><span class="hl-3">data</span><span class="hl-1">) { </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">data</span><span class="hl-1">); }</span><br/><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">onConsoleErr</span><span class="hl-1">(</span><span class="hl-3">data</span><span class="hl-1">) { </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">error</span><span class="hl-1">(</span><span class="hl-3">data</span><span class="hl-1">); }</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">anxEnv</span><span class="hl-1"> = </span><span class="hl-8">Object</span><span class="hl-1">.</span><span class="hl-6">assign</span><span class="hl-1">({}, </span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">env</span><span class="hl-1">);</span><br/><span class="hl-3">anxEnv</span><span class="hl-1">[</span><span class="hl-4">&#39;GIT_TRACE&#39;</span><span class="hl-1">] = </span><span class="hl-4">&#39;2&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">apiOptions</span><span class="hl-1"> = { </span><span class="hl-3">env:</span><span class="hl-1"> </span><span class="hl-3">anxEnv</span><span class="hl-1">, </span><span class="hl-3">outHandler:</span><span class="hl-1"> </span><span class="hl-3">onConsoleOut</span><span class="hl-1">, </span><span class="hl-3">errHandler:</span><span class="hl-1"> </span><span class="hl-3">onConsoleErr</span><span class="hl-1"> };</span>
</code></pre>
<p>The JavaScript bind function may be used to pass <code>this</code> and other parameters
to a callback as shown in the JavaScript fragment below.</p>
<pre><code class="language-javascript"><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">onAnnexOut</span><span class="hl-1">(</span><span class="hl-3">data</span><span class="hl-1">) { </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`gitAnnexOut: </span><span class="hl-2">${</span><span class="hl-2">this</span><span class="hl-9">.</span><span class="hl-3">something</span><span class="hl-2">}</span><span class="hl-4"> </span><span class="hl-2">${</span><span class="hl-3">data</span><span class="hl-2">}</span><span class="hl-4">`</span><span class="hl-1">); }</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">versionAnx</span><span class="hl-1">({}, { </span><span class="hl-3">outHandler:</span><span class="hl-1"> </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">onAnnexOut</span><span class="hl-1">.</span><span class="hl-6">bind</span><span class="hl-1">(</span><span class="hl-2">this</span><span class="hl-1">) }));</span>
</code></pre>

<a href="#command-result" id="command-result" style="color: inherit; text-decoration: none;">
  <h3>Command result</h3>
</a>
<p>The Promise returned by every command contains uninterpreted information about the process.
The CommandResult interface is described in the documentation.</p>
<p>Any method is capable of throwing an Error.
Any command that doesn&#39;t throw may return an exitCode indicating failure.
Application design must account for these eventualities.</p>
<p>Type predicates and helper functions may be used to parse command responses.
Some git-annex commands offer the ability to generate progress messages in JSON.
Other information may be present in the stdout stream.
The example below illustrates extracting progress objects using
helper function safeParseToArray filtering objects with type predicate isActionProgress.
The returned objects may be used to notify the user.</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">progress</span><span class="hl-1"> = </span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-6">safeParseToArray</span><span class="hl-1">(</span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-3">isActionProgress</span><span class="hl-1">, </span><span class="hl-3">data</span><span class="hl-1">);</span>
</code></pre>

<a href="#documentation" id="documentation" style="color: inherit; text-decoration: none;">
  <h2>Documentation</h2>
</a>
<p>The details are explained in the API
<a href="https://jstritch.github.io/easy-git-annex/">documentation</a>.</p>

<a href="#contributions" id="contributions" style="color: inherit; text-decoration: none;">
  <h2>Contributions</h2>
</a>
<p>Adding support for additional commands is usually straightforward.
Please do your work on a new branch.</p>
<p>I am an independent developer.
If you find easy-git-annex helpful, please consider becoming a
<a href="https://github.com/sponsors/jstritch">sponsor</a>.</p>

<a href="#example" id="example" style="color: inherit; text-decoration: none;">
  <h2>Example</h2>
</a>
<p>The example may be copied and run on your machine.
It creates a temporary directory,
prepares the directory for Git and git-annex,
and adds one large and one small file to a subdirectory,
and reports success or failure.
The repository remains on your system for study.</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">anx</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;easy-git-annex&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">os</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;os&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">path</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;path&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-3">promises</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">fs</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-2">async</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">setupAnnexClient</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-3">description</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-3">largefiles</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">): </span><span class="hl-8">Promise</span><span class="hl-1">&lt;</span><span class="hl-8">void</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">myAnx</span><span class="hl-1"> = </span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-6">createAccessor</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">initGit</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">configGit</span><span class="hl-1">({ </span><span class="hl-3">set:</span><span class="hl-1"> [</span><span class="hl-4">&#39;push.followTags&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;true&#39;</span><span class="hl-1">] });</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">configGit</span><span class="hl-1">({ </span><span class="hl-3">set:</span><span class="hl-1"> [</span><span class="hl-4">&#39;receive.denyCurrentBranch&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;updateInstead&#39;</span><span class="hl-1">] });</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">initAnx</span><span class="hl-1">(</span><span class="hl-3">description</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">wanted</span><span class="hl-1">(</span><span class="hl-4">&#39;here&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;standard&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">group</span><span class="hl-1">(</span><span class="hl-4">&#39;here&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;manual&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">configAnx</span><span class="hl-1">({ </span><span class="hl-4">&#39;--set&#39;</span><span class="hl-3">:</span><span class="hl-1"> [</span><span class="hl-4">&#39;annex.largefiles&#39;</span><span class="hl-1">, </span><span class="hl-3">largefiles</span><span class="hl-1">] });</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-2">async</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">addFiles</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-3">relativePaths</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> | </span><span class="hl-8">string</span><span class="hl-1">[], </span><span class="hl-3">commitMessage</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">): </span><span class="hl-8">Promise</span><span class="hl-1">&lt;</span><span class="hl-8">void</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">myAnx</span><span class="hl-1"> = </span><span class="hl-3">anx</span><span class="hl-1">.</span><span class="hl-6">createAccessor</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">addAnx</span><span class="hl-1">(</span><span class="hl-3">relativePaths</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">rslt</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">myAnx</span><span class="hl-1">.</span><span class="hl-6">commit</span><span class="hl-1">(</span><span class="hl-3">relativePaths</span><span class="hl-1">, { </span><span class="hl-4">&#39;--message&#39;</span><span class="hl-3">:</span><span class="hl-1"> </span><span class="hl-3">commitMessage</span><span class="hl-1"> });</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-3">exitCode</span><span class="hl-1"> !== </span><span class="hl-7">0</span><span class="hl-1">) { </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-8">Error</span><span class="hl-1">(</span><span class="hl-3">rslt</span><span class="hl-1">.</span><span class="hl-6">toCommandResultString</span><span class="hl-1">()); }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">async</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">runExampleClick</span><span class="hl-1">(): </span><span class="hl-8">Promise</span><span class="hl-1">&lt;</span><span class="hl-8">void</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-10">// create a directory</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">repositoryPath</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">mkdtemp</span><span class="hl-1">(</span><span class="hl-3">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">os</span><span class="hl-1">.</span><span class="hl-6">tmpdir</span><span class="hl-1">(), </span><span class="hl-4">&#39;anx-client-&#39;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-10">// setup a git-annex client</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">largefiles</span><span class="hl-1"> = </span><span class="hl-4">&#39;include=*.xtx or include=*.jpg&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">setupAnnexClient</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">, </span><span class="hl-4">&#39;images&#39;</span><span class="hl-1">, </span><span class="hl-3">largefiles</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-10">// add a subdirectory</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">exampleDir</span><span class="hl-1"> = </span><span class="hl-4">&#39;january&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">mkdir</span><span class="hl-1">(</span><span class="hl-3">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">, </span><span class="hl-3">exampleDir</span><span class="hl-1">));</span><br/><br/><span class="hl-1">    </span><span class="hl-10">// add a small and large file</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">smallFile</span><span class="hl-1"> = </span><span class="hl-3">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">exampleDir</span><span class="hl-1">, </span><span class="hl-4">&#39;small file.txt&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-5">largeFile</span><span class="hl-1"> = </span><span class="hl-3">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">exampleDir</span><span class="hl-1">, </span><span class="hl-4">&#39;large file.xtx&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">writeFile</span><span class="hl-1">(</span><span class="hl-3">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">, </span><span class="hl-3">smallFile</span><span class="hl-1">), </span><span class="hl-4">&#39;small file stored in Git</span><span class="hl-11">\n</span><span class="hl-4">&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">writeFile</span><span class="hl-1">(</span><span class="hl-3">path</span><span class="hl-1">.</span><span class="hl-6">join</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">, </span><span class="hl-3">largeFile</span><span class="hl-1">), </span><span class="hl-4">&#39;large file stored in git-annex</span><span class="hl-11">\n</span><span class="hl-4">&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">addFiles</span><span class="hl-1">(</span><span class="hl-3">repositoryPath</span><span class="hl-1">, [</span><span class="hl-3">smallFile</span><span class="hl-1">, </span><span class="hl-3">largeFile</span><span class="hl-1">], </span><span class="hl-4">&#39;add two files&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`Created </span><span class="hl-2">${</span><span class="hl-3">repositoryPath</span><span class="hl-2">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">  } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-3">e</span><span class="hl-1">: </span><span class="hl-8">unknown</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">error</span><span class="hl-1">(</span><span class="hl-3">e</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-enum"><a href="enums/RemoteCommand.html" class="tsd-kind-icon">Remote<wbr/>Command</a></li><li class="tsd-kind-enum"><a href="enums/TrustLevel.html" class="tsd-kind-icon">Trust<wbr/>Level</a></li><li class="tsd-kind-interface"><a href="interfaces/Action.html" class="tsd-kind-icon">Action</a></li><li class="tsd-kind-interface"><a href="interfaces/ActionProgress.html" class="tsd-kind-icon">Action<wbr/>Progress</a></li><li class="tsd-kind-interface"><a href="interfaces/ActionResult.html" class="tsd-kind-icon">Action<wbr/>Result</a></li><li class="tsd-kind-interface"><a href="interfaces/AddAnxOptions.html" class="tsd-kind-icon">Add<wbr/>Anx<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/AnnexOptions.html" class="tsd-kind-icon">Annex<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/ApiOptions.html" class="tsd-kind-icon">Api<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/CloneOptions.html" class="tsd-kind-icon">Clone<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/CommandResult.html" class="tsd-kind-icon">Command<wbr/>Result</a></li><li class="tsd-kind-interface"><a href="interfaces/CommitOptions.html" class="tsd-kind-icon">Commit<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/ConfigAnxOptions.html" class="tsd-kind-icon">Config<wbr/>Anx<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/ConfigGitOptions.html" class="tsd-kind-icon">Config<wbr/>Git<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/ConsoleDataHandler.html" class="tsd-kind-icon">Console<wbr/>Data<wbr/>Handler</a></li><li class="tsd-kind-interface"><a href="interfaces/FsckAnxOptions.html" class="tsd-kind-icon">Fsck<wbr/>Anx<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/FsckGitOptions.html" class="tsd-kind-icon">Fsck<wbr/>Git<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/GitAnnexAPI.html" class="tsd-kind-icon">Git<wbr/>AnnexAPI</a></li><li class="tsd-kind-interface"><a href="interfaces/InfoOptions.html" class="tsd-kind-icon">Info<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/InitGitOptions.html" class="tsd-kind-icon">Init<wbr/>Git<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/InitremoteOptions.html" class="tsd-kind-icon">Initremote<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/ListOptions.html" class="tsd-kind-icon">List<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/LockOptions.html" class="tsd-kind-icon">Lock<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/MvOptions.html" class="tsd-kind-icon">Mv<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/RemoteOptions.html" class="tsd-kind-icon">Remote<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/RepositoryInfo.html" class="tsd-kind-icon">Repository<wbr/>Info</a></li><li class="tsd-kind-interface"><a href="interfaces/RmOptions.html" class="tsd-kind-icon">Rm<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/StatusAnx.html" class="tsd-kind-icon">Status<wbr/>Anx</a></li><li class="tsd-kind-interface"><a href="interfaces/StatusAnxOptions.html" class="tsd-kind-icon">Status<wbr/>Anx<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/StatusGit.html" class="tsd-kind-icon">Status<wbr/>Git</a></li><li class="tsd-kind-interface"><a href="interfaces/StatusGitOptions.html" class="tsd-kind-icon">Status<wbr/>Git<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/SyncOptions.html" class="tsd-kind-icon">Sync<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/TagOptions.html" class="tsd-kind-icon">Tag<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/UnlockOptions.html" class="tsd-kind-icon">Unlock<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/VersionAnxOptions.html" class="tsd-kind-icon">Version<wbr/>Anx<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/VersionGitOptions.html" class="tsd-kind-icon">Version<wbr/>Git<wbr/>Options</a></li><li class="tsd-kind-function"><a href="modules.html#createAccessor" class="tsd-kind-icon">create<wbr/>Accessor</a></li><li class="tsd-kind-function"><a href="modules.html#getLineStarting" class="tsd-kind-icon">get<wbr/>Line<wbr/>Starting</a></li><li class="tsd-kind-function"><a href="modules.html#getLineStartingAsArray" class="tsd-kind-icon">get<wbr/>Line<wbr/>Starting<wbr/>As<wbr/>Array</a></li><li class="tsd-kind-function"><a href="modules.html#gitPath" class="tsd-kind-icon">git<wbr/>Path</a></li><li class="tsd-kind-function"><a href="modules.html#gitPaths" class="tsd-kind-icon">git<wbr/>Paths</a></li><li class="tsd-kind-function"><a href="modules.html#isAction" class="tsd-kind-icon">is<wbr/>Action</a></li><li class="tsd-kind-function"><a href="modules.html#isActionProgress" class="tsd-kind-icon">is<wbr/>Action<wbr/>Progress</a></li><li class="tsd-kind-function"><a href="modules.html#isActionResult" class="tsd-kind-icon">is<wbr/>Action<wbr/>Result</a></li><li class="tsd-kind-function"><a href="modules.html#isBoolean" class="tsd-kind-icon">is<wbr/>Boolean</a></li><li class="tsd-kind-function"><a href="modules.html#isKeyValue" class="tsd-kind-icon">is<wbr/>Key<wbr/>Value</a></li><li class="tsd-kind-function"><a href="modules.html#isKeyValueArray" class="tsd-kind-icon">is<wbr/>Key<wbr/>Value<wbr/>Array</a></li><li class="tsd-kind-function"><a href="modules.html#isNumber" class="tsd-kind-icon">is<wbr/>Number</a></li><li class="tsd-kind-function"><a href="modules.html#isRecord" class="tsd-kind-icon">is<wbr/>Record</a></li><li class="tsd-kind-function"><a href="modules.html#isStatusAnx" class="tsd-kind-icon">is<wbr/>Status<wbr/>Anx</a></li><li class="tsd-kind-function"><a href="modules.html#isString" class="tsd-kind-icon">is<wbr/>String</a></li><li class="tsd-kind-function"><a href="modules.html#isStringArray" class="tsd-kind-icon">is<wbr/>String<wbr/>Array</a></li><li class="tsd-kind-function tsd-has-type-parameter"><a href="modules.html#safeParse" class="tsd-kind-icon">safe<wbr/>Parse</a></li><li class="tsd-kind-function tsd-has-type-parameter"><a href="modules.html#safeParseToArray" class="tsd-kind-icon">safe<wbr/>Parse<wbr/>To<wbr/>Array</a></li></ul></nav></div></div></div><footer class=""><div class="container"><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="overlay"></div><script src="assets/main.js"></script></body></html>